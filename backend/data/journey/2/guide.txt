This is a comprehensive guide for intermediate users.